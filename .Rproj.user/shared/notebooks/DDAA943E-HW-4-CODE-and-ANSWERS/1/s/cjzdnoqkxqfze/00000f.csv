"0","Sigma = diag((3.6*sqrt(.75)*abs(x - 1/2)))^2"
"0","Xmat = cbind(rep(1,n), x)"
"0","SD.b1.het = sqrt((solve(t(Xmat)%*%Xmat)%*%t(Xmat)%*%Sigma%*%Xmat%*%solve(t(Xmat)%*%Xmat))[2,2])"
"0",""
"0","nsim = 10000"
"0","b1.het = rep(0, nsim)"
"0","se.het = rep(0, nsim)"
"0","se.het.hc = rep(0, nsim)"
"0","Epsilon.het = matrix(0, n, nsim)"
"0","for(i in 1:nsim)"
"0","{"
"0","  errors = rnorm(n, 0, 3.6*sqrt(.75)*abs(x - 1/2))"
"0","  Y = beta0 + beta1*x + errors"
"0","  lm.temp = lm(Y~x)"
"0","  b1.het[i] = lm.temp$coef[2]"
"0","  se.het[i] = summary(lm.temp)$coef[2,2]"
"0","  se.het.hc[i] = sqrt(diag(vcovHC(lm.temp, type = ""HC2"")))[2]"
"0","  Epsilon.het[,i] = errors"
"0","}"
