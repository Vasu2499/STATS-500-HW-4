"0","get_temp <- function(month, year, data, celsius = FALSE, average_fn = mean) {"
"0"," "
"0","  if (is.character(month)) {"
"0","    month <- match(tolower(month), tolower(month.abb))"
"0","  }"
"0","  "
"0","  if (is.na(month) || month < 1 || month > 12) {"
"0","    warning(""Invalid month input. Please provide a valid month (1-12, full month name, or 3-letter abbreviation)."")"
"0","    return(NULL)  ## prevent quarto rendering failure"
"0","  }"
"0","  "
"0","  if (!""month_numeric"" %in% colnames(data) || !""year"" %in% colnames(data)) {"
"0","    warning(""Data does not contain required columns: 'month_numeric' and 'year'."")"
"0","    return(NULL)  "
"0","  }"
"0",""
"0","  "
"0","  temp_data <- data %>%"
"0","    filter(month_numeric == !!month, year == !!year)"
"0","  "
"0","  "
"0","  if (nrow(temp_data) == 0) {"
"0","    message(paste(""No data found for month:"", as.character(month), ""and year:"", as.character(year)))"
"0","    warning(""No data available for the provided month and year."")"
"0","    return(NULL)  "
"0","  }"
"0",""
"0","  ## average temperature"
"0","  avg_temp <- temp_data %>%"
"0","    summarise(avg_temp = average_fn(temp, na.rm = TRUE)) %>%"
"0","    pull(avg_temp)"
"0","  "
"0","  ## Convert to Celsius "
"0","  if (celsius) {"
"0","    avg_temp <- (avg_temp - 32) * 5 / 9"
"0","  }"
"0","  "
"0","  return(avg_temp)"
"0","}"
"0",""
